{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\upload.js"
    ],
    "names": [
        "Base",
        "require",
        "fs",
        "module",
        "exports",
        "brandPicAction",
        "brandFile",
        "file",
        "think",
        "isEmpty",
        "fail",
        "that",
        "filename",
        "uuid",
        "is",
        "createReadStream",
        "path",
        "os",
        "createWriteStream",
        "ROOT_PATH",
        "pipe",
        "success",
        "name",
        "fileUrl",
        "appendDirAction",
        "isPost",
        "folderTitle",
        "post",
        "mkdir",
        "err",
        "readFloderAction",
        "Files",
        "dir",
        "stat",
        "files",
        "readdirSync",
        "i",
        "length",
        "statSync",
        "isDirectory",
        "f",
        "j",
        "push",
        "title",
        "expand",
        "children",
        "readPicsAction",
        "isFile",
        "url",
        "status",
        "removePicAction",
        "unlinkSync",
        "renameAction",
        "old",
        "newName",
        "rename"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\upload.js",
    "sourcesContent": [
        "const Base = require('./base.js');\nconst fs = require('fs');\n\nmodule.exports = class extends Base {\n  async brandPicAction() {\n    const brandFile = this.file('pic');\n    if (think.isEmpty(brandFile)) {\n      return this.fail('保存失败');\n    }\n    const that = this;\n    const filename = '/static/default/' + think.uuid(32) + '.jpg';\n    const is = fs.createReadStream(brandFile.path);\n    const os = fs.createWriteStream(think.ROOT_PATH + '/www' + filename);\n    is.pipe(os);\n\n    return that.success({\n      name: 'pic',\n      fileUrl: 'http://127.0.0.1:8360' + filename\n    });\n  }\n\n  async appendDirAction() {\n    if (!this.isPost) {\n      return false;\n    }\n    const folderTitle = this.post('folderTitle')\n    fs.mkdir(think.ROOT_PATH + '/www/static/default' + folderTitle,function(err){\n      if(err)\n        return this.fail(err)\n      return this.success();\n    })\n  }\n\n  async readFloderAction() {\n    if (!this.isPost) {\n      return false;\n    }\n    let Files = []\n    const dir = this.post('dir')\n    let stat = 0\n    const files = fs.readdirSync(think.ROOT_PATH + '/www/static/default' + dir)\n    for(var i=0; i<files.length; i++) {\n      if(fs.statSync(think.ROOT_PATH + '/www/static/default' + dir + '/' + files[i]).isDirectory()) {\n        const f = fs.readdirSync(think.ROOT_PATH + '/www/static/default' + dir + '/' + files[i])\n        if(!think.isEmpty(f)) {\n          for(var j=0; j<f.length&&fs.statSync(think.ROOT_PATH + '/www/static/default' + dir + '/' + files[i] + '/' + f[j]).isDirectory(); j++) {\n            Files.push({ title: files[i], expand: false, children: [{}]})\n            stat = 1\n            break\n          }\n          if(!stat)\n            Files.push({ title: files[i], expand: false})\n        }\n        else {\n          Files.push({ title: files[i], expand: false})\n        }\n      }\n    }\n    return this.success(Files)\n  }\n\n  async readPicsAction() {\n    if (!this.isPost) {\n      return false;\n    }\n    let Files = []\n    const dir = this.post('dir')\n    const files = fs.readdirSync(think.ROOT_PATH + '/www/static/default' + dir)\n    for(var i=0; i<files.length; i++) {\n      if(fs.statSync(think.ROOT_PATH + '/www/static/default' + dir + '/' + files[i]).isFile()) {\n        Files.push({ name:files[i],url: 'http://127.0.0.1:8360/static/default/' + files[i],status: 'finished'})\n      }\n    }\n    return this.success(Files)\n  }\n\n  async removePicAction() {\n    if (!this.isPost) {\n      return false;\n    }\n    const path = this.post('path')\n    fs.unlinkSync(think.ROOT_PATH + '/www/static/default/' + path)\n      return this.success('ok')\n  }\n\n  async renameAction() {\n    if (!this.isPost) {\n      return false;\n    }\n    const old = this.post('old')\n    const newName = this.post('new')\n    const path = this.post('path')\n    fs.rename(think.ROOT_PATH + '/www/static/default' + path + '/' + old, think.ROOT_PATH + '/www/static/default' + path + '/' +newName)\n    return this.success()\n  }\n};\n"
    ]
}