{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\tongji.js"
    ],
    "names": [
        "Base",
        "require",
        "module",
        "exports",
        "soldAction",
        "isPost",
        "dateRange",
        "post",
        "data",
        "model",
        "join",
        "order_goods",
        "on",
        "where",
        "add_time",
        "field",
        "group",
        "order",
        "select",
        "sql",
        "buildSelectSql",
        "sql1",
        "specData",
        "table",
        "sql2",
        "storeData",
        "success",
        "spec",
        "store",
        "orderCountAction",
        "season",
        "after",
        "orderData",
        "afterData",
        "i",
        "order_status",
        "length"
    ],
    "mappings": ";;AAAA,MAAMA,OAAOC,QAAQ,WAAR,CAAb;;AAEAC,OAAOC,OAAP,GAAiB,cAAcH,IAAd,CAAmB;;AAE5BI,YAAN,GAAmB;AAAA;;AAAA;AAClB,UAAI,CAAC,MAAKC,MAAV,EAAkB;AACf,eAAO,KAAP;AACD;AACD,YAAMC,YAAY,MAAKC,IAAL,CAAU,WAAV,CAAlB;AACA;AACA,YAAMC,OAAO,MAAM,MAAKC,KAAL,CAAW,OAAX,EAAoBC,IAApB,CAAyB;AAC1CC,qBAAa;AACZD,gBAAM,OADM;AAEZE,cAAI,CAAC,UAAD,EAAa,UAAb;AAFQ;AAD6B,OAAzB,EAKhBC,KALgB,CAKV,EAACC,UAAS,CAAC,SAAD,EAAWR,UAAU,CAAV,CAAX,EAAwBA,UAAU,CAAV,CAAxB,CAAV,EALU,EAKwCS,KALxC,CAK8C,2CAL9C,EAK2FC,KAL3F,CAKiG,UALjG,EAK6GC,KAL7G,CAKmH,aALnH,EAKkIC,MALlI,EAAnB;AAMA;AACA,UAAIC,MAAM,MAAM,MAAKV,KAAL,CAAW,OAAX,EAAoBI,KAApB,CAA0B,EAACC,UAAS,CAAC,SAAD,EAAWR,UAAU,CAAV,CAAX,EAAwBA,UAAU,CAAV,CAAxB,CAAV,EAA1B,EAA4EI,IAA5E,CAAiF;AAC/FC,qBAAa;AACZD,gBAAM,OADM;AAEZE,cAAI,CAAC,UAAD,EAAa,UAAb;AAFQ;AADkF,OAAjF,EAKbG,KALa,CAKP,sDALO,EAKiDC,KALjD,CAKuD,UALvD,EAKmEC,KALnE,CAKyE,aALzE,EAMfG,cANe,EAAhB;AAOA,YAAMC,OAAO,wDAAuDF,GAAvD,GAA6D,mJAA1E;AACA,YAAOG,WAAW,MAAM,MAAKb,KAAL,CAAW,OAAX,EAAoBc,KAApB,CAA0BF,IAA1B,EAAgCN,KAAhC,CAAsC,sBAAtC,EAA8DG,MAA9D,EAAxB;;AAEA;AACA,YAAMM,OAAOL,MAAM,4FAAnB;AACA,YAAMM,YAAY,MAAM,MAAKhB,KAAL,CAAW,SAAX,EAAsBc,KAAtB,CAA4BC,IAA5B,EAAkCT,KAAlC,CAAwC,0CAAxC,EAAoFG,MAApF,EAAxB;AACA,aAAO,MAAKQ,OAAL,CAAa,EAAClB,MAAKA,IAAN,EAAWmB,MAAKL,QAAhB,EAAyBM,OAAMH,SAA/B,EAAb,CAAP;AA1BiB;AA2BlB;;AAGKI,kBAAN,GAAyB;AAAA;;AAAA;AACxB,UAAI,CAAC,OAAKxB,MAAV,EAAkB;AACf,eAAO,KAAP;AACD;AACD,YAAMyB,SAAS,OAAKvB,IAAL,CAAU,QAAV,CAAf,CAJuB,CAIW;AAClC,YAAMD,YAAY,OAAKC,IAAL,CAAU,WAAV,CAAlB;AACA,UAAIU,QAAQ,EAAZ;AACA,UAAIc,QAAQ,EAAZ;AACA,UAAIC,YAAY,EAAhB;AACA,UAAIC,YAAY,EAAhB;AACA,WAAI,IAAIC,IAAG,CAAX,EAAaA,IAAE,CAAf,EAAkBA,GAAlB,EAAuB;AACrBF,oBAAY,MAAM,OAAKvB,KAAL,CAAW,OAAX,EAAoBI,KAApB,CAA0B,EAACC,UAAS,CAAC,SAAD,EAAWR,UAAU4B,CAAV,CAAX,CAAV,EAA1B,EAA+DhB,MAA/D,EAAlB;AACAe,oBAAY,MAAM,OAAKxB,KAAL,CAAW,OAAX,EAAoBI,KAApB,CAA0B,EAACC,UAAS,CAAC,SAAD,EAAWR,UAAU4B,CAAV,CAAX,CAAV,EAAmCC,cAAa,CAAhD,EAA1B,EAA8EjB,MAA9E,EAAlB;AACAD,cAAOa,SAAO,CAAP,GAASI,CAAT,GAAW,CAAZ,GAAe,GAArB,IAA4BF,UAAUI,MAAtC;AACAL,cAAOD,SAAO,CAAP,GAASI,CAAT,GAAW,CAAZ,GAAe,GAArB,IAA4BD,UAAUG,MAAtC;AACD;;AAEF,aAAO,OAAKV,OAAL,CAAa,EAACT,OAAMA,KAAP,EAAac,OAAMA,KAAnB,EAAb,CAAP;AAjBwB;AAkBxB;;AAlDiC,CAApC",
    "file": "..\\..\\..\\src\\admin\\controller\\tongji.js",
    "sourcesContent": [
        "const Base = require('./base.js');\r\n\r\nmodule.exports = class extends Base {\r\n\r\n  async soldAction() {\r\n  \tif (!this.isPost) {\r\n      return false;\r\n    }\r\n    const dateRange = this.post('dateRange')\r\n    //id,名称，销售量\r\n    const data = await this.model('order').join({\r\n      order_goods: {\r\n      \tjoin: 'inner',\r\n      \ton: ['order_sn', 'order_id']\r\n      }\r\n    }).where({add_time:['between',dateRange[0],dateRange[1]]}).field(\"sum(number) as number,goods_id,goods_name\").group('goods_id').order('number DESC').select()\r\n    //类型\r\n    let sql = await this.model('order').where({add_time:['between',dateRange[0],dateRange[1]]}).join({\r\n      order_goods: {\r\n      \tjoin: 'inner',\r\n      \ton: ['order_sn', 'order_id']\r\n      }\r\n    }).field(\"sum(number) as number,goods_id as goodsID,goods_name\").group('goods_id').order('number DESC')\r\n    .buildSelectSql()\r\n    const sql1 = '(select number,goodsID,goods_name,category_id from '+ sql + 'as aaa left join nideshop.nideshop_goods on goodsID = nideshop.nideshop_goods.id) as abb left join nideshop.nideshop_category on category_id = id'\r\n    const  specData = await this.model('goods').table(sql1).field('number as value,name').select()\r\n\r\n    //销售量/库存\r\n    const sql2 = sql + 'as aaa left join nideshop.nideshop_product on goodsID = nideshop.nideshop_product.goods_id'\r\n    const storeData = await this.model('product').table(sql2).field('number, goods_id,goods_name,goods_number').select()\r\n    return this.success({data:data,spec:specData,store:storeData})\r\n  }\r\n\r\n\r\n  async orderCountAction() {\r\n  \tif (!this.isPost) {\r\n      return false;\r\n    }\r\n    const season = this.post('season')//0-3\r\n    const dateRange = this.post('dateRange')\r\n    let order = {}\r\n    let after = {}\r\n    let orderData = []\r\n    let afterData = []\r\n    for(let i =0;i<3; i++) {\r\n      orderData = await this.model('order').where({add_time:['between',dateRange[i]]}).select()\r\n      afterData = await this.model('order').where({add_time:['between',dateRange[i]],order_status:7}).select()\r\n      order[(season*3+i+1)+'月'] = orderData.length\r\n      after[(season*3+i+1)+'月'] = afterData.length\r\n    }\r\n    \r\n  \treturn this.success({order:order,after:after})\r\n  }\r\n\r\n}"
    ]
}